<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>SceneCraft AI</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex flex-col min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-black text-gray-100">

  <!-- Header -->
  <header class="bg-gray-900/80 backdrop-blur-sm sticky top-0 z-20">
    <div class="max-w-6xl mx-auto flex items-center justify-between p-4">
      <a href="#" id="navHome" class="text-3xl font-extrabold text-yellow-400">SceneCraft AI</a>
      <nav class="flex space-x-6 text-lg">
        <a href="#" id="navAnalyzer" class="text-yellow-300 border-b-2 border-yellow-300 pb-1">Scene Analyzer</a>
        <a href="#" id="navEditor" class="hover:text-yellow-300">Scene Editor</a>
        <a href="#" id="navWriter" class="hover:text-yellow-300">Full Script Writer</a>
        <a href="#" id="navHow" class="hover:text-yellow-300">How it Works</a>
        <a href="#" id="navPricing" class="hover:text-yellow-300">Pricing</a>
      </nav>
      <button id="navLogin" class="bg-yellow-400 text-gray-900 py-2 px-4 rounded-lg">Log In / Sign Up</button>
    </div>
  </header>

  <main class="flex-grow">

    <!-- Home Narrative -->
    <section id="view-home" class="p-8 max-w-4xl mx-auto space-y-8">
      <h1 class="text-5xl font-extrabold text-yellow-400 text-center">Welcome to SceneCraft AI</h1>
      <p class="text-xl leading-relaxed text-gray-300">
        Unlock the power of cinematic insight. SceneCraft AI combines advanced machine learning 
        with filmmaker expertise to give you instant, page-to-screen feedback on your scenes.
        Perfect your pacing, sharpen your stakes, and visualize your next shot—all in one tool.
      </p>
      <img
        src="https://images.unsplash.com/photo-1590608897129-79c44746557a?auto=format&fit=crop&w=1200&q=80"
        alt="Film set with camera crew"
        class="w-full rounded-xl shadow-xl border-4 border-yellow-400"
      />
      <h2 class="text-3xl font-semibold text-yellow-300 pt-6">Features at a Glance</h2>
      <ul class="grid grid-cols-1 md:grid-cols-2 gap-6 text-gray-200">
        <li class="bg-gray-800 p-4 rounded-lg">
          <h3 class="font-semibold text-xl text-yellow-300">Scene Analyzer</h3>
          <p class="mt-2">Deep feedback on pacing, stakes, dialogue, subtext, and visual grammar.</p>
        </li>
        <li class="bg-gray-800 p-4 rounded-lg opacity-60">
          <h3 class="font-semibold text-xl">Scene Editor</h3>
          <p class="mt-2">AI-assisted rewriting and polish—coming soon.</p>
        </li>
        <li class="bg-gray-800 p-4 rounded-lg opacity-60">
          <h3 class="font-semibold text-xl">Full Script Writer</h3>
          <p class="mt-2">Generate full screenplays with genre templates—coming soon.</p>
        </li>
        <li class="bg-gray-800 p-4 rounded-lg opacity-60">
          <h3 class="font-semibold text-xl">Collaborative Dashboard</h3>
          <p class="mt-2">Save, compare, and share your analyses in one place.</p>
        </li>
      </ul>
    </section>

    <!-- Scene Analyzer -->
    <section id="view-analyzer" class="hidden p-6 max-w-3xl mx-auto bg-gray-900/80 rounded-xl space-y-4 relative mt-8">
      <button id="closeAnalyzer" class="absolute top-4 right-4 text-gray-400 hover:text-gray-100">✕ Close</button>
      <h2 class="text-3xl font-bold text-yellow-300 text-center">Scene Analyzer</h2>
      <textarea
        id="sceneInput"
        rows="6"
        class="w-full p-4 bg-gray-800 rounded-lg text-gray-100"
        placeholder="Paste your scene here..."
      ></textarea>
      <input type="file" id="sceneFile" accept=".txt,.pdf" class="text-gray-400"/>
      <label class="inline-flex items-center space-x-2 text-gray-200">
        <input type="checkbox" id="agreeChk" class="form-checkbox text-yellow-400"/>
        <span>Agree to Terms & Conditions</span>
      </label>
      <button id="analyzeBtn" class="w-full bg-yellow-400 text-gray-900 py-2 rounded-lg font-semibold">
        Analyze
      </button>
      <div id="analysisOutput" class="hidden w-full bg-gray-800 p-4 rounded-lg whitespace-pre-wrap text-gray-100"></div>
    </section>

    <!-- Terms & Conditions -->
    <section id="view-terms" class="hidden p-8 max-w-3xl mx-auto bg-gray-900/90 text-gray-200 rounded-xl relative mt-8">
      <button id="closeTerms" class="absolute top-4 right-4 text-gray-400 hover:text-gray-100">✕ Close</button>
      <h2 class="text-3xl font-bold text-yellow-300 mb-4">Terms & Conditions</h2>
      <h3 class="font-semibold text-lg mt-4">1. User Agreement</h3>
      <p>You confirm you own or have proper rights to any content (scenes, scripts, excerpts) you submit to SceneCraft AI. By submitting, you grant us permission to analyze that content.</p>

      <h3 class="font-semibold text-lg mt-4">2. Disclaimer</h3>
      <p>All feedback provided is for creative and educational purposes only. SceneCraft AI does not guarantee any results in your actual film or script production.</p>

      <h3 class="font-semibold text-lg mt-4">3. Usage Policy</h3>
      <ul class="list-disc list-inside ml-4">
        <li>Submit only original or licensed material.</li>
        <li>No hateful, harassing, or infringing content.</li>
        <li>Do not use this tool for unlawful or defamatory purposes.</li>
      </ul>

      <h3 class="font-semibold text-lg mt-4">4. Privacy & Data</h3>
      <p>We do not permanently store your submitted scenes or personal data beyond the scope of providing the analysis. You retain full ownership of your content.</p>

      <h3 class="font-semibold text-lg mt-4">5. Limitation of Liability</h3>
      <p>Under no circumstances shall SceneCraft AI or its affiliates be liable for any direct, indirect, incidental, or consequential damages arising from your use of the analysis.</p>

      <h3 class="font-semibold text-lg mt-4">6. Changes to Terms</h3>
      <p>We may update these terms at any time. Continued use after changes constitutes acceptance.</p>

      <hr class="my-6 border-gray-700"/>
      <p class="text-sm text-gray-500">&copy; 2025 SceneCraft AI. All rights reserved.</p>
    </section>

  </main>

  <script>
    // View toggling
    const show = v => {
      ['home','analyzer','terms'].forEach(x =>
        document.getElementById('view-'+x).classList.add('hidden')
      );
      document.getElementById('view-'+v).classList.remove('hidden');
    };
    // Header nav
    document.getElementById('navHome').onclick    = () => show('home');
    document.getElementById('navAnalyzer').onclick = () => show('analyzer');
    // Close buttons
    document.getElementById('closeAnalyzer').onclick = () => {
      document.getElementById('sceneInput').value = '';
      document.getElementById('sceneFile').value  = '';
      document.getElementById('agreeChk').checked  = false;
      const out = document.getElementById('analysisOutput');
      out.classList.add('hidden');
      out.innerText = '';
      show('home');
    };
    document.getElementById('ctaTerms')?.addEventListener('click', () => show('terms'));
    document.getElementById('closeTerms').onclick = () => show('home');
    document.addEventListener('keydown', e => { if(e.key==='Escape') show('home'); });

    // Analysis logic (unchanged caching & cleaning)
    let lastScene = '', lastResult = '';
    document.getElementById('analyzeBtn').onclick = () => {
      const agree = document.getElementById('agreeChk').checked;
      const out   = document.getElementById('analysisOutput');
      let scene   = document.getElementById('sceneInput').value.trim();
      const file  = document.getElementById('sceneFile');

      if(scene && scene===lastScene && lastResult){
        out.classList.remove('hidden'); out.textContent=lastResult; return;
      }

      out.classList.add('hidden'); out.innerText='';
      if(!agree) return alert('Please accept Terms & Conditions.');
      if(!scene && file.files.length){
        file.files[0].text().then(txt=>{
          scene = txt.trim();
          if(scene===lastScene && lastResult){
            out.classList.remove('hidden'); out.textContent=lastResult; return;
          }
          doAnalyze(scene,out);
        });
        return;
      }
      if(scene.length<10) return alert('Paste or upload at least 10 characters.');
      doAnalyze(scene,out);
    };

    function doAnalyze(scene, out){
      out.classList.remove('hidden');
      out.innerHTML='<p class="text-yellow-300">Analyzing...</p>';
      fetch('https://scenecraft-ai-backend.onrender.com/analyze',{
        method:'POST',
        headers:{'Content-Type':'application/json','x-user-agreement':'true'},
        body:JSON.stringify({scene,save:false})
      })
      .then(async res=>{
        const text=await res.text();
        let data; try{data=JSON.parse(text||'{}')}catch{data={}} 
        let analysis = res.ok&&data.analysis?data.analysis:data.error||data.detail||`Error ${res.status}`;
        const cleaned = analysis
          .split('\n')
          .filter(l=>!l.trim().startsWith('•'))
          .filter(l=>!/^[^:]+:\s*$/.test(l.trim()))
          .join('\n').trim();
        out.textContent=cleaned;
        lastScene=scene; lastResult=cleaned;
      })
      .catch(e=>{ out.textContent='Network error: '+e.message });
    }

    // Start on Home
    show('home');
  </script>
</body>
</html>
